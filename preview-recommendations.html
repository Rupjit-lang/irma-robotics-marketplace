<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IRMA Marketplace - Recommendation System Preview</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.js" rel="stylesheet">
    <style>
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; }
        .card { @apply bg-white border border-gray-200 rounded-lg shadow-sm; }
        .card-header { @apply px-6 py-4 border-b border-gray-200; }
        .card-content { @apply px-6 py-4; }
        .badge { @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium; }
        .badge-outline { @apply border border-gray-300 text-gray-700; }
        .btn { @apply inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md; }
        .btn-primary { @apply text-white bg-blue-600 hover:bg-blue-700; }
        .btn-outline { @apply text-gray-700 bg-white border-gray-300 hover:bg-gray-50; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Mock data for demonstration
        const mockRecommendations = [
            {
                product: {
                    id: "1",
                    title: "ABB IRB 6700 Industrial Robot - 150kg Payload",
                    category: "industrial_robots",
                    priceMinINR: 2500000,
                    priceMaxINR: 3500000,
                    leadTimeWeeks: 12,
                    org: {
                        name: "ABB Robotics India",
                        gstin: "27AABCS1234A1Z5"
                    }
                },
                score: 0.92,
                reason: "Based on your recent browsing of industrial automation equipment and high-payload requirements",
                algorithm: "browsing"
            },
            {
                product: {
                    id: "2",
                    title: "KUKA KR 210 R2700 Prime - Welding Robot System",
                    category: "welding_robots",
                    priceMinINR: 1800000,
                    priceMaxINR: 2200000,
                    leadTimeWeeks: 10,
                    org: {
                        name: "KUKA Robotics India",
                        gstin: "29AABCS5678B2Y4"
                    }
                },
                score: 0.88,
                reason: "Popular choice among automotive manufacturers in your region",
                algorithm: "industry"
            },
            {
                product: {
                    id: "3",
                    title: "Fanuc M-710iC/50 - Precision Assembly Robot",
                    category: "assembly_robots",
                    priceMinINR: 1200000,
                    priceMaxINR: 1600000,
                    leadTimeWeeks: 8,
                    org: {
                        name: "Fanuc India Pvt Ltd",
                        gstin: "19AABCS9012C3X6"
                    }
                },
                score: 0.85,
                reason: "Trending in precision manufacturing - 40% increase in orders this month",
                algorithm: "trending"
            },
            {
                product: {
                    id: "4",
                    title: "Universal Robots UR10e - Collaborative Robot",
                    category: "collaborative_robots",
                    priceMinINR: 800000,
                    priceMaxINR: 1000000,
                    leadTimeWeeks: 6,
                    org: {
                        name: "Universal Robots India",
                        gstin: "36AABCS3456D4W7"
                    }
                },
                score: 0.82,
                reason: "Similar buyers in electronics industry frequently purchase this model",
                algorithm: "similar_buyers"
            }
        ];

        const mockRecentActivity = [
            {
                id: "1",
                type: "view",
                productTitle: "ABB IRB 6700 Industrial Robot",
                timestamp: new Date(Date.now() - 30 * 60 * 1000).toISOString(),
                productCategory: "Industrial Robots"
            },
            {
                id: "2",
                type: "quote",
                productTitle: "KUKA KR 210 Welding System",
                timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),
                productCategory: "Welding Robots"
            },
            {
                id: "3",
                type: "view",
                productTitle: "Fanuc CNC Machine Center",
                timestamp: new Date(Date.now() - 4 * 60 * 60 * 1000).toISOString(),
                productCategory: "CNC Machines"
            }
        ];

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-IN', {
                style: 'currency',
                currency: 'INR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function getAlgorithmIcon(alg) {
            const icons = {
                browsing: "üëÅÔ∏è",
                industry: "üë•",
                trending: "üìà",
                similar_buyers: "üè¢",
                hybrid: "‚≠ê"
            };
            return icons[alg] || "‚≠ê";
        }

        function getAlgorithmLabel(alg) {
            const labels = {
                browsing: "Based on browsing",
                industry: "Industry popular",
                trending: "Trending now",
                similar_buyers: "Similar buyers",
                hybrid: "Personalized"
            };
            return labels[alg] || "Personalized";
        }

        function RecommendationsSection() {
            const [recommendations, setRecommendations] = useState([]);
            const [loading, setLoading] = useState(true);
            const [algorithm, setAlgorithm] = useState('hybrid');

            useEffect(() => {
                // Simulate API call
                setLoading(true);
                setTimeout(() => {
                    const filtered = algorithm === 'hybrid' 
                        ? mockRecommendations 
                        : mockRecommendations.filter(r => r.algorithm === algorithm);
                    setRecommendations(filtered);
                    setLoading(false);
                }, 1000);
            }, [algorithm]);

            if (loading) {
                return (
                    <div className="card">
                        <div className="card-header">
                            <h2 className="text-lg font-semibold flex items-center">
                                ‚≠ê Recommended for You
                            </h2>
                            <p className="text-sm text-gray-600">Loading personalized recommendations...</p>
                        </div>
                        <div className="card-content">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {[1, 2, 3, 4].map((i) => (
                                    <div key={i} className="animate-pulse">
                                        <div className="bg-gray-200 h-32 rounded-lg mb-3"></div>
                                        <div className="bg-gray-200 h-4 rounded mb-2"></div>
                                        <div className="bg-gray-200 h-3 rounded w-3/4"></div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="card">
                    <div className="card-header">
                        <div className="flex items-center justify-between">
                            <div>
                                <h2 className="text-lg font-semibold flex items-center">
                                    ‚≠ê Recommended for You
                                </h2>
                                <p className="text-sm text-gray-600">
                                    {recommendations.length} products matched to your interests
                                </p>
                            </div>
                            <div className="flex items-center space-x-2">
                                <div className="flex border rounded-lg p-1">
                                    {['hybrid', 'browsing', 'industry', 'trending'].map((alg) => (
                                        <button
                                            key={alg}
                                            onClick={() => setAlgorithm(alg)}
                                            className={`px-3 py-1 text-xs rounded ${
                                                algorithm === alg 
                                                    ? 'bg-blue-600 text-white' 
                                                    : 'text-gray-600 hover:bg-gray-100'
                                            }`}
                                        >
                                            {getAlgorithmIcon(alg)} {alg === 'hybrid' ? 'All' : 
                                             alg.charAt(0).toUpperCase() + alg.slice(1)}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div className="card-content">
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            {recommendations.map((rec) => (
                                <div
                                    key={rec.product.id}
                                    className="border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer"
                                >
                                    <div className="flex items-start justify-between mb-3">
                                        <div className="flex-1">
                                            <div className="flex items-center space-x-2 mb-2">
                                                <span className="badge badge-outline">
                                                    {rec.product.category.replace('_', ' ')}
                                                </span>
                                                <div className="flex items-center space-x-1 text-xs text-gray-500">
                                                    <span>{getAlgorithmIcon(rec.algorithm)}</span>
                                                    <span>{getAlgorithmLabel(rec.algorithm)}</span>
                                                </div>
                                            </div>
                                            <h3 className="font-medium text-gray-900 mb-1">
                                                {rec.product.title}
                                            </h3>
                                        </div>
                                        <div className="text-right ml-4">
                                            <div className="flex items-center space-x-1 text-sm text-orange-600">
                                                <span>‚≠ê</span>
                                                <span>{Math.round(rec.score * 100)}%</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="space-y-2 mb-3">
                                        <div className="flex items-center text-sm text-gray-600">
                                            <span className="mr-1">üè¢</span>
                                            <span className="truncate">{rec.product.org.name}</span>
                                        </div>
                                        
                                        <div className="flex items-center justify-between text-sm">
                                            <div className="flex items-center text-gray-600">
                                                <span className="mr-1">‚è∞</span>
                                                <span>{rec.product.leadTimeWeeks} weeks</span>
                                            </div>
                                            <div className="font-medium text-gray-900">
                                                {rec.product.priceMinINR === rec.product.priceMaxINR 
                                                    ? formatCurrency(rec.product.priceMinINR)
                                                    : `${formatCurrency(rec.product.priceMinINR)} - ${formatCurrency(rec.product.priceMaxINR)}`
                                                }
                                            </div>
                                        </div>
                                    </div>

                                    <div className="border-t pt-3">
                                        <p className="text-xs text-gray-600 mb-2">
                                            {rec.reason}
                                        </p>
                                        <div className="flex items-center justify-between">
                                            <button className="text-blue-600 hover:text-blue-800 text-sm font-medium">
                                                View Details
                                            </button>
                                            <button className="btn btn-outline text-xs px-3 py-1">
                                                Request Quote
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        function RecentActivitySection() {
            return (
                <div className="card">
                    <div className="card-header">
                        <h3 className="text-lg font-semibold flex items-center">
                            üìä Recent Activity
                        </h3>
                    </div>
                    <div className="card-content">
                        <div className="space-y-3">
                            {mockRecentActivity.map((activity) => (
                                <div key={activity.id} className="flex items-center space-x-3">
                                    <div className="flex-shrink-0">
                                        {activity.type === 'view' ? 'üëÅÔ∏è' : 
                                         activity.type === 'quote' ? 'üì¶' : 'üõí'}
                                    </div>
                                    <div className="flex-1 min-w-0">
                                        <p className="text-sm font-medium text-gray-900 truncate">
                                            {activity.type === 'view' ? 'Viewed' : 
                                             activity.type === 'quote' ? 'Requested Quote' : 'Ordered'} {activity.productTitle}
                                        </p>
                                        <div className="flex items-center space-x-2">
                                            <span className="badge badge-outline text-xs">
                                                {activity.productCategory}
                                            </span>
                                            <span className="text-xs text-gray-500">
                                                {new Date(activity.timestamp).toLocaleTimeString()}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        function App() {
            return (
                <div className="min-h-screen bg-gray-50">
                    <header className="bg-white shadow-sm border-b">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <h1 className="text-2xl font-bold text-gray-900">
                                ü§ñ IRMA Marketplace - Recommendation System Preview
                            </h1>
                            <p className="text-gray-600 mt-1">
                                Interactive demo of the personalized product recommendation engine
                            </p>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto px-4 py-8">
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div className="lg:col-span-2">
                                <RecommendationsSection />
                            </div>
                            <div className="lg:col-span-1">
                                <RecentActivitySection />
                            </div>
                        </div>

                        <div className="mt-8 p-6 bg-blue-50 rounded-lg">
                            <h3 className="text-lg font-semibold text-blue-900 mb-3">
                                üéØ Recommendation Engine Features
                            </h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <h4 className="font-medium text-blue-800 mb-2">Algorithm Types:</h4>
                                    <ul className="space-y-1 text-blue-700">
                                        <li>üëÅÔ∏è Browsing-based recommendations</li>
                                        <li>üë• Industry-specific suggestions</li>
                                        <li>üìà Trending products analysis</li>
                                        <li>üè¢ Similar buyer patterns</li>
                                        <li>‚≠ê Hybrid scoring system</li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 className="font-medium text-blue-800 mb-2">Key Features:</h4>
                                    <ul className="space-y-1 text-blue-700">
                                        <li>üéØ Real-time personalization</li>
                                        <li>üìä User interaction tracking</li>
                                        <li>üîÑ Dynamic algorithm switching</li>
                                        <li>üí∞ Price-aware recommendations</li>
                                        <li>üìç Region-based trending</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>